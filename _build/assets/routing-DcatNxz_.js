import{J as N,a as v,g as se,A as D,y as z,e as j,n as oe,o as T,K as ae,I as ce,u as ie,L as ue,N as le,b as fe}from"./web-DqPol8Cv.js";function he(){let e=new Set;function t(s){return e.add(s),()=>e.delete(s)}let n=!1;function r(s,o){if(n)return!(n=!1);const a={to:s,options:o,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const i of e)i.listener({...a,from:i.location,retry:l=>{l&&(n=!0),i.navigate(s,{...o,resolve:!1})}});return!a.defaultPrevented}return{subscribe:t,confirm:r}}let k;function H(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),k=window.history.state._depth}H();function je(e){return{...e,_depth:window.history.state&&window.history.state._depth}}function Be(e,t){let n=!1;return()=>{const r=k;H();const s=r==null?null:k-r;if(n){n=!1;return}s&&t(s)?(n=!0,window.history.go(-s)):e()}}const de=/^(?:[a-z0-9]+:)?\/\//i,pe=/^\/+|(\/)\/+$/g,me="http://sr";function b(e,t=!1){const n=e.replace(pe,"$1");return n?t||/^[?#]/.test(n)?n:"/"+n:""}function B(e,t,n){if(de.test(t))return;const r=b(e),s=n&&b(n);let o="";return!s||t.startsWith("/")?o=r:s.toLowerCase().indexOf(r.toLowerCase())!==0?o=r+s:o=s,(o||"/")+b(t,!o)}function ge(e,t){if(e==null)throw new Error(t);return e}function ye(e,t){return b(e).replace(/\/*(\*.*)?$/g,"")+b(t)}function J(e){const t={};return e.searchParams.forEach((n,r)=>{t[r]=n}),t}function ve(e,t,n){const[r,s]=e.split("/*",2),o=r.split("/").filter(Boolean),a=o.length;return i=>{const l=i.split("/").filter(Boolean),f=l.length-a;if(f<0||f>0&&s===void 0&&!t)return null;const h={path:a?"":"/",params:{}},y=p=>n===void 0?void 0:n[p];for(let p=0;p<a;p++){const d=o[p],m=l[p],w=d[0]===":",A=w?d.slice(1):d;if(w&&M(m,y(A)))h.params[A]=m;else if(w||!M(m,d))return null;h.path+=`/${m}`}if(s){const p=f?l.slice(-f).join("/"):"";if(M(p,y(s)))h.params[s]=p;else return null}return h}}function M(e,t){const n=r=>r.localeCompare(e,void 0,{sensitivity:"base"})===0;return t===void 0?!0:typeof t=="string"?n(t):typeof t=="function"?t(e):Array.isArray(t)?t.some(n):t instanceof RegExp?t.test(e):!1}function we(e){const[t,n]=e.pattern.split("/*",2),r=t.split("/").filter(Boolean);return r.reduce((s,o)=>s+(o.startsWith(":")?2:3),r.length-(n===void 0?0:1))}function X(e){const t=new Map,n=se();return new Proxy({},{get(r,s){return t.has(s)||N(n,()=>t.set(s,v(()=>e()[s]))),t.get(s)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(e())}})}function G(e){let t=/(\/?\:[^\/]+)\?/.exec(e);if(!t)return[e];let n=e.slice(0,t.index),r=e.slice(t.index+t[0].length);const s=[n,n+=t[1]];for(;t=/^(\/\:[^\/]+)\?/.exec(r);)s.push(n+=t[1]),r=r.slice(t[0].length);return G(r).reduce((o,a)=>[...o,...s.map(i=>i+a)],[])}const Re=100,Pe=z(),Q=z(),F=()=>ge(D(Pe),"<A> and 'use' router primitives can be only used inside a Route."),xe=()=>D(Q)||F().base,Fe=e=>{const t=xe();return v(()=>t.resolvePath(e()))},_e=e=>{const t=F();return v(()=>{const n=e();return n!==void 0?t.renderPath(n):n})},Ie=()=>F().navigatorFactory(),Me=()=>F().location;function be(e,t=""){const{component:n,preload:r,load:s,children:o,info:a}=e,i=!o||Array.isArray(o)&&!o.length,l={key:e,component:n,preload:r||s,info:a};return V(e.path).reduce((f,h)=>{for(const y of G(h)){const p=ye(t,y);let d=i?p:p.split("/*",1)[0];d=d.split("/").map(m=>m.startsWith(":")||m.startsWith("*")?m:encodeURIComponent(m)).join("/"),f.push({...l,originalPath:h,pattern:d,matcher:ve(d,!i,e.matchFilters)})}return f},[])}function Ae(e,t=0){return{routes:e,score:we(e[e.length-1])*1e4-t,matcher(n){const r=[];for(let s=e.length-1;s>=0;s--){const o=e[s],a=o.matcher(n);if(!a)return null;r.unshift({...a,route:o})}return r}}}function V(e){return Array.isArray(e)?e:[e]}function Ce(e,t="",n=[],r=[]){const s=V(e);for(let o=0,a=s.length;o<a;o++){const i=s[o];if(i&&typeof i=="object"){i.hasOwnProperty("path")||(i.path="");const l=be(i,t);for(const f of l){n.push(f);const h=Array.isArray(i.children)&&i.children.length===0;if(i.children&&!h)Ce(i.children,f.pattern,n,r);else{const y=Ae([...n],r.length);r.push(y)}n.pop()}}}return n.length?r:r.sort((o,a)=>a.score-o.score)}function $(e,t){for(let n=0,r=e.length;n<r;n++){const s=e[n].matcher(t);if(s)return s}return[]}function Ee(e,t){const n=new URL(me),r=v(l=>{const f=e();try{return new URL(f,n)}catch{return console.error(`Invalid path ${f}`),l}},n,{equals:(l,f)=>l.href===f.href}),s=v(()=>r().pathname),o=v(()=>r().search,!0),a=v(()=>r().hash),i=()=>"";return{get pathname(){return s()},get search(){return o()},get hash(){return a()},get state(){return t()},get key(){return i()},query:X(T(o,()=>J(r())))}}let R;function $e(){return R}function ke(e){}function De(e,t,n,r={}){const{signal:[s,o],utils:a={}}=e,i=a.parsePath||(c=>c),l=a.renderPath||(c=>c),f=a.beforeLeave||he(),h=B("",r.base||"");if(h===void 0)throw new Error(`${h} is not a valid base path`);h&&!s().value&&o({value:h,replace:!0,scroll:!1});const[y,p]=j(!1);let d;const m=(c,u)=>{u.value===w()&&u.state===C()||(d===void 0&&p(!0),R=c,d=u,ae(()=>{d===u&&(A(d.value),Y(d.state),le(),q[1]([]))}).finally(()=>{d===u&&ce(()=>{R=void 0,c==="navigate"&&ne(d),p(!1),d=void 0})}))},[w,A]=j(s().value),[C,Y]=j(s().state),E=Ee(w,C),S=[],q=j([]),U=v(()=>typeof r.transformUrl=="function"?$(t(),r.transformUrl(E.pathname)):$(t(),E.pathname)),Z=X(()=>{const c=U(),u={};for(let g=0;g<c.length;g++)Object.assign(u,c[g].params);return u}),W={pattern:h,path:()=>h,outlet:()=>null,resolvePath(c){return B(h,c)}};return oe(T(s,c=>m("native",c),{defer:!0})),{base:W,location:E,params:Z,isRouting:y,renderPath:l,parsePath:i,navigatorFactory:te,matches:U,beforeLeave:f,preloadRoute:re,singleFlight:r.singleFlight===void 0?!0:r.singleFlight,submissions:q};function ee(c,u,g){ie(()=>{if(typeof u=="number"){u&&(a.go?a.go(u):console.warn("Router integration does not support relative routing"));return}const L=!u||u[0]==="?",{replace:_,resolve:P,scroll:I,state:x}={replace:!1,resolve:!L,scroll:!0,...g};let Se;const O=P?c.resolvePath(u):B(L&&E.pathname||"",u);if(O===void 0)throw new Error(`Path '${u}' is not a routable path`);if(S.length>=Re)throw new Error("Too many redirects");const K=w();(O!==K||x!==C())&&(ue||f.confirm(O,g)&&(S.push({value:K,replace:_,scroll:I,state:C()}),m("navigate",{value:O,state:x})))})}function te(c){return c=c||D(Q)||W,(u,g)=>ee(c,u,g)}function ne(c){const u=S[0];u&&(o({...c,replace:u.replace,scroll:u.scroll}),S.length=0)}function re(c,u={}){const g=$(t(),c.pathname),L=R;R="preload";for(let _ in g){const{route:P,params:I}=g[_];P.component&&P.component.preload&&P.component.preload();const{preload:x}=P;u.preloadData&&x&&N(n(),()=>x({params:I,location:{pathname:c.pathname,search:c.search,hash:c.hash,query:J(c),state:null,key:""},intent:"preload"}))}R=L}}function qe(e,t,n,r){const{base:s,location:o,params:a}=e,{pattern:i,component:l,preload:f}=r().route,h=v(()=>r().path);l&&l.preload&&l.preload();const y=f?f({params:a,location:o,intent:R||"initial"}):void 0;return{parent:t,pattern:i,path:h,outlet:()=>l?fe(l,{params:a,location:o,data:y,get children(){return n()}}):n(),resolvePath(d){return B(s.path(),d,h())}}}export{Pe as R,De as a,Q as b,Ce as c,qe as d,H as e,he as f,$e as g,Me as h,Fe as i,_e as j,je as k,b as l,me as m,Be as n,ke as s,Ie as u};
